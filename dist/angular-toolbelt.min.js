/*! angular-toolbelt 08-07-2014 */
angular.module("sysen.toolbelt",["sysen.toolbelt.tpls","toolbelt.growl","toolbelt.infiniteScroll","toolbelt.scroll","toolbelt.strength","toolbelt.navbar"]),angular.module("sysen.toolbelt.tpls",["toolbelt.growl.tpl","toolbelt.strength.tpl"]),angular.module("toolbelt.navbar",[]).directive("sysActiveNavbar",["$location",function(a){function b(b){var e;angular.forEach(b.find("a"),function(b){var c=angular.element(b),f=c.attr("data-route")||"",g=new RegExp("^"+f.replace("/","\\/")+"$",["i"]);g.test(a.path())?e=c:d(c,"active")}),void 0!==e&&c(e,"active")}function c(a,b){for(;void 0===a.attr("data-sys-active-navbar")&&"BODY"!==a.prop("tagName");)a.hasClass(b)||a.addClass(b),a=a.parent()}function d(a,b){for(;void 0===a.attr("data-sys-active-navbar")&&"BODY"!==a.prop("tagName");)a.hasClass(b)&&a.removeClass(b),a=a.parent()}return{link:function(c,d){c.$watch(function(){return a.path()},function(){b(d)})}}}]),angular.module("toolbelt.growl",["ngSanitize"]).directive("sysGrowl",["$rootScope","$timeout",function(a,b){return{replace:!1,templateUrl:"template/toolbelt/growl.html",link:function(c,d,e){c.limit=parseInt(e.sysGrowl,10)||5,c.growls=[],c.dismiss=function(b){var d=c.growls.indexOf(b);c.growls.splice(d,1),a.$broadcast("_removeGrowl",b)},a.$on("_addGrowl",function(a,d){void 0===d.type&&(d.type="info"),c.growls.unshift(d),e.timeout&&b(function(){c.dismiss(d)},1e3*e.timeout)})}}}]),angular.module("toolbelt.infiniteScroll",[]).directive("sysInfiniteScroll",["$rootScope","$window","$timeout",function(a,b,c){return{link:function(d,e,f){var g=f.timeout||1e3;d.dataLoad=!1,d.stopped=!1;var h=function(){var f=d.dataLoad||d.stopped;if(!f){var h=e.prop("offsetTop")+e.prop("offsetHeight"),i=b.scrollY+b.innerHeight;h&&i-h>=0&&(d.dataLoad=!0,d.timeout=c(function(){d.dataLoad=!1},g),a.$broadcast("_infiniteScroll","DATA_LOAD"))}};a.$on("_infiniteScroll",function(a,b){switch(b){case"STOP":d.stopped=!0;break;case"START":d.stopped=!1;break;case"CONTINUE":d.dataLoad=!1,c.cancel(d.timeout)}}),angular.element(b).bind("scroll",h)}}}]),angular.module("toolbelt.scroll",[]).directive("sysScroll",["$rootScope","$window","$interval",function(a,b,c){var d=function(){return b.pageYOffset?b.pageYOffset:b.document.body.scrollTop?b.document.body.scrollTop:0},e=function(a,c){var d=b.document.getElementById(a);return d?d.offsetTop-c:0},f=function(a,f,g){var h,i=d(),j=e(f,g);if(h=j-i,0!==h)switch(a){case"smooth":var k=1,l=20,m=0;0>h&&(h=-h,m=1);var n=Math.ceil(h/l);c(function(){m>0?(i-=l,j>i&&(i=j)):(i+=l,i>j&&(i=j)),b.scrollTo(0,i)},k,n);break;default:b.scrollTo(0,i+h)}};return{link:function(b,c,d){var e=0;c.on("click",function(){if(d.target){var a=d.sysScroll||"normal",b=d.target,c=d.offset||e;f(a,b,c)}}),a.$on("_pageScroll",function(a,b,c){c=c||e,f("none",b,c)})}}}]),angular.module("toolbelt.strength",["ngSanitize"]).directive("sysStrength",function(){function a(a){return/[a-z]+/.test(a)}function b(a){return/[A-Z]+/.test(a)}function c(a){return/[0-9]+/.test(a)}function d(a){return/[$-/:-?{-~!"^_`\[\]]/g.test(a)}function e(a,b){var c=100*a/20,d=20>c?g[1]:35>c?g[2]:50>c?g[3]:65>c?g[4]:90>c?g[5]:g[6],e=b-d.rank;return e>=f.length?e=f.length-1:0>e&&(e=0),d.label=f[e],d}var f=["success","warning","danger"],g=[{rank:1,complexity:"Too Short",label:"danger"},{rank:2,complexity:"Very Weak"},{rank:3,complexity:"Weak"},{rank:4,complexity:"Poor"},{rank:5,complexity:"Good"},{rank:6,complexity:"Strong"},{rank:7,complexity:"Very Strong"}];return{require:"ngModel",scope:{model:"=ngModel",target:"@"},replace:!0,templateUrl:"template/toolbelt/strength.html",link:function(f,h,i){var j=parseInt(i.minLength)||6,k=parseInt(i.complexity)||5;k>7&&(k=7);var l=h.inheritedData("$formController"),m=function(h){if(h){var i=0;a(h)&&i++,b(h)&&i++,c(h)&&i++,d(h)&&i++,i*=h.length/2,f.result=h.length>=j?e(i,k):g[0]}else f.result=g[0];l[f.target].$setValidity("strength",k<=f.result.rank)};f.$watch("model",m)}}}),angular.module("toolbelt.growl.tpl",[]).run(["$templateCache",function(a){a.put("template/toolbelt/growl.html",['<article data-ng-repeat="growl in growls | limitTo: limit">','    <div class="alert alert-{{ growl.type }} alert-dismissable">','        <button type="button" class="close" data-ng-click="dismiss(growl)">&times;</button>',"        <h4>{{ growl.title }}</h4>",'        <p data-ng-bind-html="growl.content"></p>',"    </div>","</article>"].join("\n"))}]),angular.module("toolbelt.strength.tpl",[]).run(["$templateCache",function(a){a.put("template/toolbelt/strength.html",'<span class="label label-{{ result.label }}">{{ result.complexity }}</span>')}]);