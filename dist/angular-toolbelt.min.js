/*! angular-toolbelt 22-07-2014 */
angular.module("sysen.toolbelt",["sysen.toolbelt.services","sysen.toolbelt.directives","sysen.toolbelt.tpls"]),angular.module("sysen.toolbelt.services",["toolbelt.platform"]),angular.module("sysen.toolbelt.directives",["toolbelt.growl","toolbelt.infiniteScroll","toolbelt.scroll","toolbelt.strength","toolbelt.navbar"]),angular.module("sysen.toolbelt.tpls",["toolbelt.growl.tpl","toolbelt.strength.tpl"]),angular.module("toolbelt.navbar",[]).directive("sysActiveNavbar",["$location",function(a){function b(b){var e;angular.forEach(b.find("a"),function(b){var c=angular.element(b),f=c.attr("data-route")||"",g=new RegExp("^"+f.replace("/","\\/")+"$",["i"]);g.test(a.path())?e=c:d(c,"active")}),void 0!==e&&c(e,"active")}function c(a,b){for(;void 0===a.attr("data-sys-active-navbar")&&"BODY"!==a.prop("tagName");)a.hasClass(b)||a.addClass(b),a=a.parent()}function d(a,b){for(;void 0===a.attr("data-sys-active-navbar")&&"BODY"!==a.prop("tagName");)a.hasClass(b)&&a.removeClass(b),a=a.parent()}return{link:function(c,d){c.$watch(function(){return a.path()},function(){b(d)})}}}]),angular.module("toolbelt.growl",["ngSanitize"]).directive("sysGrowl",["$rootScope","$timeout",function(a,b){return{replace:!1,templateUrl:"template/toolbelt/growl.html",link:function(c,d,e){c.limit=parseInt(e.sysGrowl,10)||5,c.growls=[],c.dismiss=function(b){var d=c.growls.indexOf(b);c.growls.splice(d,1),a.$broadcast("_removeGrowl",b)},a.$on("_addGrowl",function(a,d){void 0===d.type&&(d.type="info"),c.growls.unshift(d),e.timeout&&b(function(){c.dismiss(d)},1e3*e.timeout)})}}}]),angular.module("toolbelt.infiniteScroll",[]).directive("sysInfiniteScroll",["$rootScope","$window","$timeout",function(a,b,c){return{link:function(d,e,f){var g=f.timeout||1e3;d.dataLoad=!1,d.stopped=!1;var h=function(){var f=d.dataLoad||d.stopped;if(!f){var h=e.prop("offsetTop")+e.prop("offsetHeight"),i=b.scrollY+b.innerHeight;h&&i-h>=0&&(d.dataLoad=!0,d.timeout=c(function(){d.dataLoad=!1},g),a.$broadcast("_infiniteScroll","DATA_LOAD"))}};a.$on("_infiniteScroll",function(a,b){switch(b){case"STOP":d.stopped=!0;break;case"START":d.stopped=!1;break;case"CONTINUE":d.dataLoad=!1,c.cancel(d.timeout)}}),angular.element(b).bind("scroll",h)}}}]),angular.module("toolbelt.scroll",[]).directive("sysScroll",["$rootScope","$window","$interval",function(a,b,c){var d=function(){return b.pageYOffset?b.pageYOffset:b.document.body.scrollTop?b.document.body.scrollTop:0},e=function(a,c){var d=b.document.getElementById(a);return d?d.offsetTop-c:0},f=function(a,f,g){var h,i=d(),j=e(f,g);if(h=j-i,0!==h)switch(a){case"smooth":var k=1,l=20,m=0;0>h&&(h=-h,m=1);var n=Math.ceil(h/l);c(function(){m>0?(i-=l,j>i&&(i=j)):(i+=l,i>j&&(i=j)),b.scrollTo(0,i)},k,n);break;default:b.scrollTo(0,i+h)}};return{link:function(b,c,d){var e=0;c.on("click",function(){if(d.target){var a=d.sysScroll||"normal",b=d.target,c=d.offset||e;f(a,b,c)}}),a.$on("_pageScroll",function(a,b,c){c=c||e,f("none",b,c)})}}}]),angular.module("toolbelt.strength",["ngSanitize"]).directive("sysStrength",function(){function a(a){return/[a-z]+/.test(a)}function b(a){return/[A-Z]+/.test(a)}function c(a){return/[0-9]+/.test(a)}function d(a){return/[$-/:-?{-~!"^_`\[\]]/g.test(a)}function e(a,b){var c=100*a/20,d=20>c?g[1]:35>c?g[2]:50>c?g[3]:65>c?g[4]:90>c?g[5]:g[6],e=b-d.rank;return e>=f.length?e=f.length-1:0>e&&(e=0),d.label=f[e],d}var f=["success","warning","danger"],g=[{rank:1,complexity:"Too Short",label:"danger"},{rank:2,complexity:"Very Weak"},{rank:3,complexity:"Weak"},{rank:4,complexity:"Poor"},{rank:5,complexity:"Good"},{rank:6,complexity:"Strong"},{rank:7,complexity:"Very Strong"}];return{require:"ngModel",scope:{model:"=ngModel",target:"@"},replace:!0,templateUrl:"template/toolbelt/strength.html",link:function(f,h,i){var j=parseInt(i.minLength)||6,k=parseInt(i.complexity)||5;k>7&&(k=7);var l=h.inheritedData("$formController"),m=function(h){if(h){var i=0;a(h)&&i++,b(h)&&i++,c(h)&&i++,d(h)&&i++,i*=h.length/2,f.result=h.length>=j?e(i,k):g[0]}else f.result=g[0];l[f.target].$setValidity("strength",k<=f.result.rank)};f.$watch("model",m)}}}),angular.module("toolbelt.platform",[]).provider("$detectPlatform",function(){function a(a){var b,c,d,e=a.navigator.userAgent,f=e.match(/(windows|macintosh|linux)/i)||[];if(b=f[0],!b)return{name:"Unknown",version:"0"};switch(b.toLowerCase()){case"windows":d=e.match(/windows\snt\s([^;)]*)/i)||[],c=d[1];break;case"macintosh":d=e.match(/(mac\sos\s?x)\s([^;)]*)/i)||[],b=d[1],c=d[2].replace(/_/g,".");break;case"linux":d=e.match(/ubuntu/i)||[],c=d[0]}return{name:b,version:c}}function b(a){var b,c,d,e=a.navigator.userAgent,f=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+(\.\d+)?(\.\d+)?)/i)||[];return/trident/i.test(f[1])?(d=/\brv[ :]+(\d+(\.\d+)?(\.\d+)?)/g.exec(e),b="MSIE",c=d[1]):"Chrome"===f[1]&&(d=e.match(/\bOPR\/(\d+(\.\d+)?(\.\d+)?)/),null!=d&&(b="Opera",c=d[1])),b||c||(f=f[2]?[f[1],f[2]]:[a.navigator.appName,a.navigator.appVersion,"-?"],null!=(d=e.match(/version\/(\d+(\.\d+)?(\.\d+)?)/i))&&f.splice(1,1,d[1]),b=f[0],c=f[1]),{name:b||"Unknown",version:c||"0"}}var c=this;c.approvedBrowsers=[],c.allowBrowser=function(a,b){return this.approvedBrowsers.push({name:a,version:b||0}),c},c.$get=["$window",function(d){var e=a(d),f=b(d);return{language:d.navigator.language,system:{name:e.name,version:e.version,matches:function(a,b){return b?this.name&&this.name==a&&this.version==b:this.name&&this.name==a}},browser:{name:f.name,version:f.version,matches:function(a,b){return b?this.name&&this.name==a&&this.version==b:this.name&&this.name==a},isAllowed:function(){for(var a=0;a<c.approvedBrowsers.length;a++)if(this.name==c.approvedBrowsers[a].name&&parseFloat(this.version)>=parseFloat(c.approvedBrowsers[a].version))return!0;return!1}}}}]}),angular.module("toolbelt.growl.tpl",[]).run(["$templateCache",function(a){a.put("template/toolbelt/growl.html",['<article data-ng-repeat="growl in growls | limitTo: limit">','    <div class="alert alert-{{ growl.type }} alert-dismissable">','        <button type="button" class="close" data-ng-click="dismiss(growl)">&times;</button>',"        <h4>{{ growl.title }}</h4>",'        <p data-ng-bind-html="growl.content"></p>',"    </div>","</article>"].join("\n"))}]),angular.module("toolbelt.strength.tpl",[]).run(["$templateCache",function(a){a.put("template/toolbelt/strength.html",'<span class="label label-{{ result.label }}">{{ result.complexity }}</span>')}]);